---
title: Структуры
date: 2025-03-08 15:00:00
showTableOfContents: true
showComments: true
katex: true
tags:
  - zig
  - zigbook
  - struct
---

Для завершения базового блока ознакомления с языком Zig нам осталось рассмотреть еще одну очень важную тему - структуры. Так как язык Zig ближе к языку C, чем к таким языкам как C++ и Java в нем нет привычного для этих языков подхода к ООП в виде классов, наследования и интерфейсов. В языке Zig для реализации некоторых принципов ООП используются структуры.

Структуры (struct) — это одна из ключевых конструкций в Zig, позволяющая группировать данные и создавать пользовательские типы. Они используются для организации сложных данных, представления объектов и моделирования реальных сущностей. В этой главе мы подробно рассмотрим, как работать со структурами в Zig, их синтаксис, особенности и примеры использования.

## Определение структур
Для того чтобы определить структуру в языке Zig используется ключевое слово `struct` после которого идет имя вашей структуры и фигурные скобки, в которых определяются поля структуры. Рассмотрим простой пример структуры, представляющей точку в двумерном пространстве:

```zig
const Point = struct {
    x: i32,
    y: i32,
};
```

Имя структуры должно по возможности выразительно описывать ее назначение и содержимое. Например, если структура представляет собой данные о пользователе, ее имя может быть `User`, а если она содержит информацию о товаре, то `Product`. Это поможет другим разработчикам понять, что именно хранит данная структура и как ее использовать. В блоке структуры, внутри фигурных скобок, мы определяем имена и типы элементов данных, которые называются «поля». Определение структуры всегда должно заканчиваться точкой с запятой.

Для того чтобы создать экземпляр структуры, мы используем ее имя и передаем значения для каждого поля в фигурных скобках. Например, чтобы создать экземпляр структуры `Point` с координатами (10, 20), мы пишем:

```zig
const std = @import("std");
const Point = struct {
    x: i32,
    y: i32,
};

pub fn main() void {
    var p = Point{ .x = 10, .y = 20 };
    std.debug.print("Point: ({d}, {d})\n", .{ p.x, p.y });
}
```

Этот код создает экземпляр структуры `Point` с координатами (10, 20) и выводит его на экран:

```
Point: (10, 20)
```

Часто для создания экземпляров структур используется конструктор, который позволяет инициализировать поля структуры в более удобном и читаемом виде. Например, для структуры `Point` можно создать конструктор:

```zig
const std = @import("std");
const Point = struct {
    x: i32,
    y: i32,

    pub fn init(x: i32, y: i32) Point {
        return Point{ .x = x, .y = y };
    }
};

pub fn main() void {
    var p = Point.init(10, 20);
    std.debug.print("Point: ({d}, {d})\n", .{ p.x, p.y });
}
```

В данной реализации мы создаем экземпляр структуры `Point` с помощью конструктора `new`, который принимает координаты `x` и `y` и возвращает экземпляр структуры `Point` с этими координатами. Обычно для простых структур конструкторы не нужны, так как можно использовать инициализацию в фигурных скобках. Но если у вас внутри структуры есть динамической выделение памяти с использованием аллокаторов, то скорее всего Вам понадобится код, который выделит память для структуры и инициализирует ее поля. В этом случае Вам также будет необходим деструктор для структуры, который освободит выделенную память и позволит избежать утечек памяти в вашей программе.

По соглашениею в языке Zig для имен конструкторов и деструкторов структур используются имена `init` и `deinit` соответственно. Вы конечно можете использовать удобное Вам имя для конструктора, но для деструктора рекомендуется использовать имя `deinit`.
